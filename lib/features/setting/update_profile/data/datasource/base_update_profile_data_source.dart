import 'dart:convert';import 'dart:developer';import 'package:dio/dio.dart';import 'package:shared_preferences/shared_preferences.dart';import 'package:squeak/core/error/exception.dart';import 'package:squeak/core/error/error_message_model.dart';import 'package:squeak/features/setting/update_profile/data/model/species_model.dart';import 'package:squeak/core/network/dio.dart';import '../../../../../core/network/end-points.dart';import '../../../../../core/service/service_locator.dart';import '../../domain/repository/base_update_profile_repository.dart';import '../../domain/usecase/add_vac_pet_use_case.dart';import '../../domain/usecase/delete_pet_use_case.dart';import '../../domain/usecase/post_pets_use_case.dart';import '../../domain/usecase/update_pits_use_case.dart';import '../model/add_peets_model.dart';import '../model/beeds_type_model.dart';import '../model/find_pet_by_owner_id_model.dart';import '../model/update_profile_model.dart';import 'package:http/http.dart' as http;import '../model/vac_model.dart';abstract class BaseUpdateProfileRemoteDataSource {  ///todo profile  Future<UpdateProfileModel> getUpdateProfile(UpdateProfileParameters parameter);  ///todo Get Method  Future<SpeciesModel> getAllSpecies();  Future<BreedTypeModel> getBreedBySpeciesId(GetBreedBySpeciesIdParameters parameters);  Future<AddNewPetModel> postVacPetsBaseDataSource(PostVacPetsParameters parameters);  Future<FindPetByOwnerIdModel> getPetOwnerByBaseDataSource();  Future<VacModel> getAllVacBaseDataSource();  Future<VacModel> getVacPetBaseDataSource(GetVacByPetIdParameters parameters);  ///todo post Method  Future<AddNewPetModel> upDatePetsBaseDataSource(UpdatePetsParameters parameters);  Future<AddNewPetModel> postPetsBaseDataSource(PostPetsParameters parameters);  ///todo delete method  Future<AddNewPetModel> deletePetsBaseDataSource(DeletePetParameters parameters);}class UpdateProfileRemoteDataSource extends BaseUpdateProfileRemoteDataSource {  @override  Future<UpdateProfileModel> getUpdateProfile(      UpdateProfileParameters parameter) async {    var result = await DioFinalHelper.patchData(        method: '$version$getProfileEndPoint',        token: sl<SharedPreferences>().getString('refreshToken'),        data: {          "userName": parameter.userName,          "imageName": parameter.imageName,          "birthDate": parameter.birthDate,          "gender": parameter.gender,          "fullName": parameter.fullName,          "address": parameter.address,          "phoneNumber": parameter.phoneNumber,          "userType": parameter.userType        });    return UpdateProfileModel.fromJson(result.data!);  }  @override  Future<SpeciesModel> getAllSpecies() async {    var result = await DioFinalHelper.getData(      method: '$version$allSpeciesEndPoint',      token: sl<SharedPreferences>().getString('refreshToken'),    );    return SpeciesModel.fromJson(result.data!);  }  @override  Future<BreedTypeModel> getBreedBySpeciesId(      GetBreedBySpeciesIdParameters parameters) async {    var result = await DioFinalHelper.getData(      method: '$version$allBreedBySpeciesId${parameters.speciesId}',      token: sl<SharedPreferences>().getString('refreshToken'),    );    return BreedTypeModel.fromJson(result.data!);  }  @override  Future<AddNewPetModel> postPetsBaseDataSource(      PostPetsParameters parameters) async {    try{      var result = await DioFinalHelper.postData(        method: '$version$addPetEndPint',        token: sl<SharedPreferences>().getString('refreshToken'),        data: {          "petName": parameters.petName,          "gender": parameters.gender,          "breedId": parameters.breedId,          "imageName": parameters.imageName,          "birthdate": parameters.birthdate,        },      );      return AddNewPetModel.fromJson(result.data!);    } on DioException catch (error) {      return AddNewPetModel.fromJson(error.response!.data);    }  }  @override  Future<AddNewPetModel> upDatePetsBaseDataSource(      UpdatePetsParameters parameters) async {    var result = await DioFinalHelper.patchData(      method: '$version$updatePetEndPint${parameters.petId}',      token: sl<SharedPreferences>().getString('refreshToken'),      data: {        "petName": parameters.petName,        "gender": parameters.gender,        "breedId": parameters.breedId,        "imageName": parameters.image,        "birthdate": parameters.birthdate,        "ownerId": parameters.ownerClientId      },    );    return AddNewPetModel.fromJson(result.data!);  }  @override  Future<FindPetByOwnerIdModel> getPetOwnerByBaseDataSource() async {    var result = await DioFinalHelper.getData(      method: '$version$getOwnerPetEndPoint',      token: sl<SharedPreferences>().getString('refreshToken'),    );    return FindPetByOwnerIdModel.fromJson(result.data!);  }  @override  Future<VacModel> getAllVacBaseDataSource() async {    var result = await DioFinalHelper.getData(      method: '$version$allVacEndPoint',      token: sl<SharedPreferences>().getString('refreshToken'),    );    print(result.data);    return VacModel.fromJson(result.data!);  }  @override  Future<AddNewPetModel> postVacPetsBaseDataSource(      PostVacPetsParameters parameters) async {    var headers = {      'Accept-Language': 'ar',      'Content-Type': 'application/json',      'Authorization': 'Bearer $token',      'Cookie':          '.AspNetCore.Identity.Application=CfDJ8FshzpANtM1MsvvouM1YODDh9nnr7zBmr0_rjUjCFfVfqkXrgq5ZiLUylTCgXxlCr9nbuMGzSRG7uDbUyO63zwlKdv4jBnJnrbxk5fPoyRks5sH1NnsP3vYnp8EAwgB-h4g6DwfMy_t-X5yCSgHtEen7iB8Bjzn-BT-38quNufoTWMMJ2K2FvGDs1AjqOWDL5SwYEBXKu5tcDxD7aURn9XeB8HSXNP1tYHFn14oLC0wko94lKJU2U7P3G55Ex8TPZsHJPWZXHMRmu4JwBAAOe6CUC_5kO--mrJEPOuqnJbAr3_-NSsxFQ64mqTEE7pUeOUNOdKo_p_uZ-5AHSRsZ0mVb_LO_n-8Ono5M7Hg50ebxtCy11ze1qfezoX7vXwf0i6MFdjbt6YVn6gG9vscGCb_DSipu_pTnm5ekGvExqdrKNzPu-y3IUBlJP289np17xwFOZkJwPnyQTzEU9XzzRoG1uTIooYtSVpBghjwI12DeYihFkesAcfS5AgGJKmGAlhQj3vivqxqdroi0BePhq5W3QOjaI9k0mC_GgiJM59mhE-BhobZIpDUJ0RqTyfWHILtaz83dEDUWjOYdnCiRraVclsY8fnCaF4FsclMkDYu1QEQuORfdk3eXwlwXgC2q4y3WReAT3zoPnJ4UYvi1AJf8XgPWzbZFpAtI85S5d6EvUERBXn7od8p_KZoGDGtpmxa4NrfG0b5P-VKrZotCVldvZC0XOoaAXV9MN8UzJB-6Sr8lNQvUxzHQsN-PLAFb-Q'    };    var request =        http.Request('POST', Uri.parse('$baseApiUrl$version$petVacEndPoint'));    request.body = json.encode({      "petId": parameters.petId,      "vaccinationId": parameters.vaccinationId,      "vacDate": parameters.vacDate,      "comment": parameters.comment,      "statues": parameters.statues,    });    request.headers.addAll(headers);    http.StreamedResponse response = await request.send();    if (response.statusCode == 200) {      print(await response.stream.bytesToString());    } else {      print(response.reasonPhrase);    }    return AddNewPetModel.fromJson(response.headers);  }  @override  Future<AddNewPetModel> deletePetsBaseDataSource(      DeletePetParameters parameters) async {    var headers = {      'Accept-Language': 'ar',      'Content-Type': 'application/json',      'Authorization': 'Bearer ${sl<SharedPreferences>().getString('refreshToken')}',      'Cookie':          '.AspNetCore.Identity.Application=CfDJ8FshzpANtM1MsvvouM1YODDh9nnr7zBmr0_rjUjCFfVfqkXrgq5ZiLUylTCgXxlCr9nbuMGzSRG7uDbUyO63zwlKdv4jBnJnrbxk5fPoyRks5sH1NnsP3vYnp8EAwgB-h4g6DwfMy_t-X5yCSgHtEen7iB8Bjzn-BT-38quNufoTWMMJ2K2FvGDs1AjqOWDL5SwYEBXKu5tcDxD7aURn9XeB8HSXNP1tYHFn14oLC0wko94lKJU2U7P3G55Ex8TPZsHJPWZXHMRmu4JwBAAOe6CUC_5kO--mrJEPOuqnJbAr3_-NSsxFQ64mqTEE7pUeOUNOdKo_p_uZ-5AHSRsZ0mVb_LO_n-8Ono5M7Hg50ebxtCy11ze1qfezoX7vXwf0i6MFdjbt6YVn6gG9vscGCb_DSipu_pTnm5ekGvExqdrKNzPu-y3IUBlJP289np17xwFOZkJwPnyQTzEU9XzzRoG1uTIooYtSVpBghjwI12DeYihFkesAcfS5AgGJKmGAlhQj3vivqxqdroi0BePhq5W3QOjaI9k0mC_GgiJM59mhE-BhobZIpDUJ0RqTyfWHILtaz83dEDUWjOYdnCiRraVclsY8fnCaF4FsclMkDYu1QEQuORfdk3eXwlwXgC2q4y3WReAT3zoPnJ4UYvi1AJf8XgPWzbZFpAtI85S5d6EvUERBXn7od8p_KZoGDGtpmxa4NrfG0b5P-VKrZotCVldvZC0XOoaAXV9MN8UzJB-6Sr8lNQvUxzHQsN-PLAFb-Q'    };    var request = http.Request(        'DELETE',        Uri.parse(            '$baseApiUrl$version$addPetEndPint/${parameters.petId}'));    request.headers.addAll(headers);    http.StreamedResponse response = await request.send();    if (response.statusCode == 200) {      print(await response.stream.bytesToString());    } else {      print(response.reasonPhrase);    }    return AddNewPetModel.fromJson(response.headers);  }  @override  Future<VacModel> getVacPetBaseDataSource(      GetVacByPetIdParameters parameters) async {    Map<String, dynamic>? data;    var r = await DioFinalHelper.getData(      method: '$version$allVacPetEndPoint${parameters.petId}',      token: sl<SharedPreferences>().getString('refreshToken'),    ).then((value) {      data = value.data;      print(value.data);    });    return VacModel.fromJson(data!);  }}